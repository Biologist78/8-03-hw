# Домашнее задание к занятию "5. Оркестрация кластером Docker контейнеров на примере Docker Swarm" - Александр Шубин	

---

## Задача 1

Дайте письменые ответы на следующие вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
	Для реплицированного сервиса вы указываете, сколько идентичных задач хотите запустить. Например, вы решили развернуть сервис HTTP с тремя репликами, каждая из которых обслуживает один и тот же контент.
	
	Глобальный сервис — это сервис, который запускает одну задачу на каждой ноде. Предварительно заданного количества задач нет. Каждый раз, когда вы добавляете ноду в swarm, оркестратор создает задачу, а планировщик назначает задачу новой ноде. По официальной документации, хорошими кандидатами на роль глобальных сервисов являются агенты мониторинга, антивирусные сканеры или другие типы контейнеров, которые вы хотите запустить на каждой ноде в swarm.
	
- Какой алгоритм выбора лидера используется в Docker Swarm кластере?
	Алгоритм поддержания распределенного консенсуса — Raft.
	
- Что такое Overlay Network?
	
	Overlay Network создает подсеть, которую могут использовать контейнеры в разных хостах swarm-кластера. Контейнеры на разных физических хостах могут обмениваться данными по overlay-сети (если все они прикреплены к одной сети). Overlay Network использует технологию vxlan, которая инкапсулирует layer 2 фреймы в layer 4 пакеты (UDP/IP). При помощи этого действия Docker создает виртуальные сети поверх существующих связей между хостами, которые могут оказаться внутри одной подсети. Любые точки, которые являются частью этой виртуальной сети, выглядят друг для друга так, будто они связаны поверх свича и не заботятся об устройстве основной физической сети.
	
## Задача 2

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker node ls
```
![alt text](/virt/05-virt-05/img/2023-02-27_16-28-54.png)

## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```
![alt text](/virt/05-virt-05/img/2023-02-27_16-33-43.png)

![alt text](/virt/05-virt-05/img/2023-02-27_16-36-34.png)


## Задача 4 (*)

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true
```
![alt text](/virt/05-virt-05/img/2023-02-27_16-37-48.png)

На сколько я понял мы шифруем ключи шифрования TLS, которые в свою очередь нужны для дешифровки журнала Raft. Если я справильно понимаю, не зная этого ключа мы не можем разблокировать swarm, и добавить (удалить) ноды, и провести какие либо изменения.



